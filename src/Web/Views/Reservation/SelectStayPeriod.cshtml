@model Web.Models.Reservation.ReservationPeriodViewModel

@{
    ViewData["Title"] = "Select stay period";
}

<h2>@ViewData["Title"]</h2>

<hr />

<div class="row">
    <div class="col-md-8">
        <form asp-action="SelectStayPeriod">
            @Html.HiddenFor(m => m.CheckinDate)
            @Html.HiddenFor(m => m.CheckoutDate)

            <div class="form-group row flex-v-center">
                <div class="col-xs-3 col-sm-2">
                    <label for="FromDate">From</label>
                </div>
                <div class="col-xs-3">
                    <p class="input-group">
                        <input type="text" class="form-control" id="FromDate" value="@Model.CheckinDate.ToShortDateString()" readonly />
                    </p>
                </div>
                <div class="col-xs-1 text-center">
                    <label for="ToDate">to</label>
                </div>
                <div class="col-xs-3">
                    <p class="input-group">
                        <input type="text" class="form-control" id="ToDate" value="@Model.CheckoutDate.ToShortDateString()" readonly />
                    </p>
                </div>
            </div>

            <div class="form-group">
                <input type="submit" value="Proceed to reservation" class="btn btn-default" />
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        $(document).ready(function () {
            $('#FromDate').datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true,
                todayHighlight: true,
                startDate: '0d'
            }).on('changeDate', function () {
                var startDate = $('#FromDate').datepicker('getDate');
                $('#CheckinDate').val(startDate.toLocaleDateString());
                var endDate = $('#ToDate').datepicker('getDate');

                startDate.setDate(startDate.getDate() + 1);
                $('#ToDate').datepicker('setStartDate', startDate);

                if (startDate >= endDate) {
                    $('#ToDate').datepicker('setDate', startDate);
                    $('#CheckoutDate').val(startDate.toLocaleDateString());
                }
            });

            var minEndDate = $('#FromDate').datepicker('getDate');
            minEndDate.setDate(minEndDate.getDate() + 1);

            $('#ToDate').datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true,
                todayHighlight: true,
                startDate: minEndDate
            }).on('changeDate', function () {
                var toDate = $('#ToDate').datepicker('getDate');
                $('#CheckoutDate').val(toDate.toLocaleDateString());
            });
        });
    </script>
}
